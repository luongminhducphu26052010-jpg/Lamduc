<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Noel 3D</title>
<style>
  body { margin: 0; overflow: hidden; background: black; }

  #greeting {
    position: fixed;
    top: 20px;
    width: 100%;
    text-align: center;
    font-size: 46px;
    font-weight: bold;
    color: #fff;
    font-family: Arial, sans-serif;
    pointer-events: none;
    text-shadow:
      0 0 10px #ff0,
      0 0 20px #ff0,
      0 0 35px #ff8800;
    animation: glow 2s infinite alternate, scaleText 3s infinite ease-in-out;
  }

  @keyframes glow {
    from { text-shadow: 0 0 10px #ff0; }
    to   { text-shadow: 0 0 35px #ff8800; }
  }
  @keyframes scaleText {
    0%,100% { transform: scale(1); }
    50% { transform: scale(1.08); }
  }
</style>
</head>
<body>

<div id="greeting">ðŸŽ„ ChÃºc Lam GiÃ¡ng Sinh Zui Záº» áº¡ ðŸŽ„</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
// ===== SCENE =====
const scene = new THREE.Scene();

// ===== CAMERA =====
const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 1000);
camera.position.set(0, 8, 22);

// ===== RENDERER =====
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
renderer.setPixelRatio(devicePixelRatio);
document.body.appendChild(renderer.domElement);

// ===== LIGHT =====
scene.add(new THREE.AmbientLight(0xffffff, 0.8));
const light = new THREE.PointLight(0xffffff, 1.5);
light.position.set(10, 20, 10);
scene.add(light);

// ===== TREE =====
const tree = new THREE.Group();
scene.add(tree);
const greenMat = new THREE.MeshStandardMaterial({ color: 0x0b8a3b });

for (let i = 0; i < 8; i++) {
  const cone = new THREE.Mesh(
    new THREE.ConeGeometry(6 - i * 0.6, 2.5, 64),
    greenMat
  );
  cone.position.y = i * 1.4;
  tree.add(cone);
}

// ===== TRUNK =====
const trunk = new THREE.Mesh(
  new THREE.CylinderGeometry(0.9, 1.1, 3),
  new THREE.MeshStandardMaterial({ color: 0x6b3e1e })
);
trunk.position.y = -2;
tree.add(trunk);

// ===== STAR (NGÃ”I SAO ÄÃšNG) =====
const starShape = new THREE.Shape();
for (let i = 0; i < 10; i++) {
  const r = i % 2 === 0 ? 1 : 0.45;
  const a = i * Math.PI / 5;
  const x = Math.cos(a) * r;
  const y = Math.sin(a) * r;
  i === 0 ? starShape.moveTo(x,y) : starShape.lineTo(x,y);
}
starShape.closePath();

const star = new THREE.Mesh(
  new THREE.ExtrudeGeometry(starShape,{ depth:0.3, bevelEnabled:false }),
  new THREE.MeshStandardMaterial({
    color: 0xffd700,
    emissive: 0xffd700,
    emissiveIntensity: 1.6
  })
);
star.position.y = 12.6;
tree.add(star);

// ===== LIGHTS ON TREE =====
const bulbs = [];
const colors = [0xff0000,0xffff00,0x00ffcc,0xff00ff];

for (let i = 0; i < 120; i++) {
  const c = colors[i % colors.length];
  const bulb = new THREE.Mesh(
    new THREE.SphereGeometry(0.18,16,16),
    new THREE.MeshStandardMaterial({
      color: c,
      emissive: c,
      emissiveIntensity: 1.5
    })
  );
  const a = i * 0.35;
  const y = i * 0.1;
  const r = 4.5 - y * 0.25;
  bulb.position.set(Math.cos(a)*r, y, Math.sin(a)*r);
  bulbs.push(bulb);
  tree.add(bulb);
}

// ===== SNOWMAN (Máº¶T + TAY VáºªY) =====
function snowman(x){
  const g = new THREE.Group();
  const white = new THREE.MeshStandardMaterial({ color: 0xffffff });

  const b1 = new THREE.Mesh(new THREE.SphereGeometry(1.2,32,32), white);
  const b2 = new THREE.Mesh(new THREE.SphereGeometry(0.9,32,32), white);
  const head = new THREE.Mesh(new THREE.SphereGeometry(0.6,32,32), white);
  b2.position.y = 1.4;
  head.position.y = 2.6;

  // eyes
  const eyeMat = new THREE.MeshStandardMaterial({ color: 0x000000 });
  const eye1 = new THREE.Mesh(new THREE.SphereGeometry(0.08,16,16), eyeMat);
  const eye2 = eye1.clone();
  eye1.position.set(-0.15,2.75,0.55);
  eye2.position.set(0.15,2.75,0.55);

  // nose
  const nose = new THREE.Mesh(
    new THREE.ConeGeometry(0.07,0.4,16),
    new THREE.MeshStandardMaterial({ color: 0xff8800 })
  );
  nose.position.set(0,2.65,0.75);
  nose.rotation.x = Math.PI/2;

  // arm
  const arm = new THREE.Mesh(
    new THREE.CylinderGeometry(0.06,0.06,2),
    new THREE.MeshStandardMaterial({ color: 0x8b5a2b })
  );
  arm.position.set(1.1,1.8,0);
  arm.rotation.z = Math.PI/4;

  g.add(b1,b2,head,eye1,eye2,nose,arm);
  g.position.set(x,-1,0);
  scene.add(g);

  return arm;
}

const wavingArm = snowman(6);
snowman(-6);

// ===== SNOW =====
const snowGeo = new THREE.BufferGeometry();
const snow = [];
for (let i = 0; i < 1500; i++) {
  snow.push(
    (Math.random()-0.5)*120,
    Math.random()*70,
    (Math.random()-0.5)*120
  );
}
snowGeo.setAttribute("position", new THREE.Float32BufferAttribute(snow,3));
const snowMesh = new THREE.Points(
  snowGeo,
  new THREE.PointsMaterial({ color: 0xffffff, size: 0.2 })
);
scene.add(snowMesh);

// ===== ANIMATION =====
function animate(){
  requestAnimationFrame(animate);

  tree.rotation.y += 0.002;
  star.rotation.y += 0.03;

  bulbs.forEach((b,i)=>{
    b.material.emissiveIntensity = 1.2 + Math.sin(Date.now()*0.01+i);
  });

  wavingArm.rotation.z = Math.PI/4 + Math.sin(Date.now()*0.004)*0.5;

  const p = snowMesh.geometry.attributes.position.array;
  for (let i = 1; i < p.length; i += 3) {
    p[i] -= 0.15;
    if (p[i] < -5) p[i] = 70;
  }
  snowMesh.geometry.attributes.position.needsUpdate = true;

  renderer.render(scene,camera);
}
animate();

addEventListener("resize", ()=>{
  camera.aspect = innerWidth/innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});
</script>

</body>
</html>
